# Trading Engine Configuration

# Trading Configuration
trading:
  enabled: true  # LIVE TRADING ENABLED
  testnet: false  # Production mode

  symbols:
    - FARTCOIN-USDT    # ATR Limit strategy (8.44x Return/DD)
    - TRUMPSOL-USDT    # Contrarian mean reversion (5.17x Return/DD)
    - 1000PEPE-USDT    # Contrarian SHORT (9.02x Return/DD)

  strategies:
    fartcoin_atr_limit:
      enabled: true  # ⭐ ATR Expansion + Limit Orders (8.44x Return/DD)
      base_risk_pct: 48.5        # Flat $6 USDT position size ($6 / $12.38 * 100%)
      max_risk_pct: 48.5
      max_positions: 1           # ~94 trades/month (21% fill rate)

      # Strategy parameters (from 32-day BingX backtest: +101.11%, -11.98% DD, 42.6% WR)
      atr_expansion_mult: 1.5    # ATR > 1.5x average = volatility breakout
      atr_lookback_bars: 20      # Lookback for ATR average
      ema_distance_max_pct: 3.0  # Max 3% distance from EMA(20)

      # Limit order parameters
      limit_offset_pct: 1.0      # Place limit 1% away from signal price
      max_wait_bars: 3           # Wait max 3 bars for limit fill

      # Exit parameters
      stop_atr_mult: 2.0         # Stop loss distance (2x ATR)
      target_atr_mult: 8.0       # Take profit distance (8x ATR) = 4:1 R:R
      max_hold_bars: 200         # Time exit after 200 bars (3.3 hours)

      # Risk settings
      win_streak_scaling: 0.5    # Risk increase per win
      use_trailing_stop: false   # No trailing - let TP hit
      use_partial_exits: false   # No partial exits - full TP or SL
      max_hold_hours: 3.5        # Max 3.5 hours in trade

    trumpsol_contrarian:
      enabled: true  # ✅ Mean Reversion (5.17x Return/DD, 68.8% WR)
      base_risk_pct: 48.5        # Flat $6 USDT position size ($6 / $12.38 * 100%)
      max_risk_pct: 48.5
      max_positions: 1           # ~77 trades/month (2.4/day)

      # Strategy parameters (from 32-day BingX backtest: +17.49%, -3.38% DD, 68.8% WR)
      params:
        min_ret_5m_pct: 1.0      # Min 1% move in 5 minutes
        vol_ratio_min: 1.0       # Volume >= 30-min average
        atr_ratio_min: 1.1       # ATR >= 110% of 30-min average
        excluded_hours: [1, 5, 17]  # Europe/Warsaw hours to skip

        # Fixed % exits
        stop_loss_pct: 1.0       # 1% SL from entry
        take_profit_pct: 1.5     # 1.5% TP from entry
        max_hold_bars: 15        # Max 15 minutes in trade

        # Lookback periods
        vol_ma_period: 30        # 30-bar volume MA
        atr_ma_period: 30        # 30-bar ATR MA

      win_streak_scaling: 0.5    # Risk increase per win
      use_trailing_stop: false   # No trailing - let TP/time exit hit
      use_partial_exits: false   # No partial exits - full TP or SL
      max_hold_hours: 0.25       # Max 15 minutes

    pepe_contrarian_short:
      enabled: true  # ✅ Contrarian SHORT (9.02x Return/DD, 72.7% WR)
      base_risk_pct: 48.5        # Flat $6 USDT position size
      max_risk_pct: 48.5
      max_positions: 1           # ~22 trades/month (0.7/day)

      # Strategy parameters (from 30-day BingX backtest: +8.21%, -0.91% DD, 72.7% WR)
      params:
        min_ret_5m_pct: 1.5      # Min 1.5% pump in 5 minutes
        vol_ratio_min: 2.0       # Volume >= 2x 30-bar average
        atr_ratio_min: 1.3       # ATR >= 130% of 30-bar average

        # Exit parameters
        stop_atr_mult: 1.5       # 1.5x ATR SL
        target_atr_mult: 2.0     # 2.0x ATR TP
        max_hold_bars: 15        # Max 15 minutes

        # Lookback periods
        vol_ma_period: 30        # 30-bar volume MA
        atr_ma_period: 30        # 30-bar ATR MA

      win_streak_scaling: 0.5    # Risk increase per win
      use_trailing_stop: false   # No trailing - let TP hit
      use_partial_exits: false   # No partial exits - full TP or SL
      max_hold_hours: 0.25       # Max 15 minutes

    multi_timeframe_long:
      enabled: false  # DISABLED - old strategy
      base_risk_pct: 1.0
      max_risk_pct: 3.0
      max_positions: 1

      # Strategy parameters (from backtest)
      body_threshold: 1.2        # Min body % for entry
      volume_multiplier: 3.0     # Min volume surge
      wick_threshold: 0.35       # Max wick as % of body
      rsi_long_min: 45           # Min RSI for long
      stop_atr_mult: 3.0         # Stop loss distance (ATR)
      target_atr_mult: 12.0      # Take profit distance (ATR)
      win_streak_scaling: 0.5    # Risk increase per win
      use_trailing_stop: true    # Enable trailing stops
      use_partial_exits: true    # Enable partial profit taking
      max_hold_hours: 24         # Max time in trade

      # 5-min filter
      rsi_5min_min: 57           # Min 5-min RSI for entry
      distance_from_sma: 0.6     # Min % distance from 50 SMA

    trend_distance_short:
      enabled: false  # DISABLED - old strategy
      base_risk_pct: 1.5
      max_risk_pct: 4.0
      max_positions: 1

      # Strategy parameters
      body_threshold: 1.2        # Min body % for entry
      volume_multiplier: 3.0     # Min volume surge
      wick_threshold: 0.35       # Max wick as % of body
      rsi_short_min: 25          # Min RSI for short
      rsi_short_max: 55          # Max RSI for short
      stop_atr_mult: 3.0         # Stop loss distance (ATR)
      target_atr_mult: 15.0      # Take profit distance (ATR)
      win_streak_scaling: 0.5    # Risk increase per win
      use_trailing_stop: true    # Enable trailing stops
      use_partial_exits: true    # Enable partial profit taking
      max_hold_hours: 24         # Max time in trade

      # Trend filter
      distance_from_50sma: 2.0   # Min % below 50 SMA
      below_200sma: true         # Must be below 200 SMA

    moodeng_rsi_momentum:
      enabled: false  # DISABLED - old strategy
      base_risk_pct: 2.0         # Higher risk due to excellent R:R
      max_risk_pct: 5.0
      max_positions: 2           # Can run 2 positions (only ~4 trades/day)

      params:
        # Strategy parameters (from backtest: +24.02%, -2.25% DD, 31% WR)
        rsi_cross_level: 55        # RSI must cross above this
        min_body_pct: 0.5          # Min bullish candle body %
        stop_atr_mult: 1.0         # Tight stop (1x ATR)
        target_atr_mult: 4.0       # Wide target (4x ATR) = 4:1 R:R
        max_hold_bars: 60          # Time exit after 60 minutes
        win_streak_scaling: 0.5    # Risk increase per win
        use_trailing_stop: false   # No trailing - let TP hit
        use_partial_exits: false   # No partial exits - full TP or SL
        max_hold_hours: 1          # Max 1 hour in trade

    doge_volume_zones:
      enabled: false  # DISABLED for now
      base_risk_pct: 2.0         # Good R:R (7.15x Return/DD)
      max_risk_pct: 5.0
      max_positions: 1           # ~25 trades/month, 1 at a time

      params:
        # Strategy parameters (from backtest: +8.14%, -1.14% DD, 52% WR)
        volume_threshold: 1.5      # 1.5x average volume
        min_zone_bars: 5           # Min 5 consecutive elevated volume bars
        max_zone_bars: 15          # Max zone length
        lookback_bars: 20          # Bars to look back for price extremes
        stop_atr_mult: 2.0         # Stop loss (2x ATR)
        rr_ratio: 2.0              # Take profit (2:1 R:R)
        max_hold_bars: 90          # Time exit after 90 minutes
        session_filter: overnight  # 21:00-07:00 UTC only (critical!)
        win_streak_scaling: 0.5    # Risk increase per win
        use_trailing_stop: false   # No trailing - let TP hit
        use_partial_exits: false   # No partial exits - full TP or SL
        max_hold_hours: 1.5        # Max 1.5 hours in trade

    pepe_volume_zones:
      enabled: true
      base_risk_pct: 2.0         # Best R:R for shallow DD (6.80x Return/DD)
      max_risk_pct: 5.0
      max_positions: 1           # ~15 trades/month

      params:
        # Strategy parameters (from backtest: +2.57%, -0.38% DD, 66.7% WR)
        # SHALLOWEST DRAWDOWN and HIGHEST WIN RATE!
        volume_threshold: 1.5      # 1.5x average volume
        min_zone_bars: 5           # Min 5 consecutive elevated volume bars
        max_zone_bars: 15          # Max zone length
        lookback_bars: 20          # Bars to look back for price extremes
        stop_atr_mult: 1.0         # TIGHTER stop (1x ATR vs 2x for DOGE)
        rr_ratio: 2.0              # Take profit (2:1 R:R)
        max_hold_bars: 90          # Time exit after 90 minutes
        session_filter: overnight  # 21:00-07:00 UTC only
        win_streak_scaling: 0.5    # Risk increase per win
        use_trailing_stop: false   # No trailing - let TP hit
        use_partial_exits: false   # No partial exits - full TP or SL
        max_hold_hours: 1.5        # Max 1.5 hours in trade

    trump_volume_zones:
      enabled: true
      base_risk_pct: 1.5         # HIGHEST R:R (10.56x Return/DD) but outlier-dependent!
      max_risk_pct: 4.0          # Slightly lower due to outlier dependency
      max_positions: 1           # ~21 trades/month

      params:
        # Strategy parameters (from backtest: +8.06%, -0.76% DD, 61.9% WR)
        # WARNING: OUTLIER-DEPENDENT - 88.6% profit from top 20% trades!
        # MUST take ALL signals to catch big winners
        volume_threshold: 1.5      # 1.5x average volume
        min_zone_bars: 5           # Min 5 consecutive elevated volume bars
        max_zone_bars: 15          # Max zone length
        lookback_bars: 20          # Bars to look back for price extremes
        sl_type: fixed_pct         # CRITICAL: Fixed % stop, NOT ATR!
        sl_value: 0.5              # 0.5% fixed stop loss
        rr_ratio: 4.0              # WIDER target (4:1 R:R vs 2:1 for DOGE/PEPE)
        max_hold_bars: 90          # Time exit after 90 minutes
        session_filter: overnight  # 21:00-07:00 UTC only
        win_streak_scaling: 0.5    # Risk increase per win
        use_trailing_stop: false   # No trailing - let TP hit
        use_partial_exits: false   # No partial exits - full TP or SL
        max_hold_hours: 1.5        # Max 1.5 hours in trade

    uni_volume_zones:
      enabled: true
      base_risk_pct: 2.0         # BEST Return/DD ratio (17.98x)!
      max_risk_pct: 5.0
      max_positions: 1           # ~195 trades over 3 months (~65/month)

      params:
        # Strategy parameters (from backtest: +31.99%, -1.78% DD, 45.1% WR)
        # BEST Return/DD - excels at catching distribution zones before crashes
        # 8 out of 10 top trades were SHORTS on whale distribution
        volume_threshold: 1.3      # LOWER than others (1.3 vs 1.5)
        min_zone_bars: 3           # SHORTER zones (3 vs 5)
        max_zone_bars: 15          # Max zone length
        lookback_bars: 20          # Bars to look back for price extremes
        stop_atr_mult: 1.0         # Tight stop (1x ATR)
        rr_ratio: 4.0              # Wide target (4:1 R:R for big moves)
        max_hold_bars: 90          # Time exit after 90 minutes
        session_filter: asia_eu    # 00:00-14:00 UTC (DIFFERENT from others!)
        win_streak_scaling: 0.5    # Risk increase per win
        use_trailing_stop: false   # No trailing - let TP hit
        use_partial_exits: false   # No partial exits - full TP or SL
        max_hold_hours: 1.5        # Max 1.5 hours in trade

  risk_management:
    max_portfolio_risk: 5.0     # % of account
    max_drawdown: 35.0          # % before emergency stop (updated for 10x leverage)
    cooldown_after_loss: 60     # minutes
    max_consecutive_losses: 3   # Stop after N losses
    max_daily_loss_pct: 25.0    # Max daily loss % (updated for 10x leverage)
    max_position_size_pct: 40   # Max % of capital per position

# Data Feed
data:
  provider: binance  # binance, coinbase, etc.
  websocket_url: wss://stream.binance.com:9443/ws
  rest_api_url: https://api.binance.com/api/v3

  candle_interval: 1m
  buffer_size: 300  # Keep last 300 candles

  # Data validation
  max_price_change_pct: 20.0   # Flag if price changes > 20%
  min_volume_threshold: 100    # Min volume per candle

  # Reconnection
  reconnect_attempts: 5
  reconnect_delay_seconds: 5
  max_reconnect_delay: 60

# BingX API
bingx:
  api_key: OCdqe4dHf1VpXw0Jbk3uoQTsa5CLp73rnRisvvzo2MDNp492d989QKee4znGmuLDccvnNDmRckbzEZms1AZg
  api_secret: bCxPlsFtwm5RsWgslRFaqr7jDzZiAY41gfQ1jmdAurTTz3uhjESBGB5FoqqFvLhyMLs7lD4uK6j89Lbf3AIw
  testnet: false
  base_url: https://open-api.bingx.com

  # Rate limiting
  requests_per_minute: 1200

  # Leverage Configuration
  default_leverage: 1  # 1x for now (100% of equity). Increase later: 2x=200%, 10x=1000%
  fixed_position_value_usdt: 6.0  # Flat $6 USDT position size per trade

  # Leverage Mode:
  # - 'conservative': Same position size as 1x, less margin required
  #                   Drawdown remains ~same as backtest
  #                   Can run more positions simultaneously
  # - 'aggressive': Position size multiplied by leverage
  #                 10x faster profits AND losses
  #                 Drawdown will be ~10x backtest (10-20% instead of 1-2%)
  leverage_mode: 'aggressive'  # 'conservative' or 'aggressive'

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  console_output: true
  file_output: true
  file_path: ./logs/trading-engine.log
  max_size_mb: 50
  backup_count: 5

  # Structured logging format
  json_format: false  # Set true for production

  # Performance dashboard
  dashboard_interval_minutes: 60  # Print status every N minutes

# Database
database:
  type: sqlite  # or postgresql
  path: ./data/trades.db

  # For PostgreSQL (uncomment and configure):
  # host: localhost
  # port: 5432
  # database: trading
  # user: trader
  # password: secret

  # Performance
  echo: false  # Set true to see SQL queries
  pool_size: 5
  max_overflow: 10

# Safety Features
safety:
  dry_run: false  # LIVE EXECUTION ENABLED

  # Emergency stop
  stop_file: ./STOP  # Create this file to halt trading
  emergency_stop_enabled: true

  # Pre-flight checks
  min_account_balance: 5.0  # Min USDT balance to trade
  check_existing_positions: true

  # Graceful shutdown
  close_positions_on_shutdown: false  # Close all positions on SIGTERM
  max_shutdown_wait_seconds: 30

# Email Notifications
notifications:
  enabled: true
  resend_api_key: re_idgwdJii_DXCTg91a243UwyefiKX9hDwR
  to_email: krystian.todoraszko@gmail.com
  from_email: trading-bot@resend.dev
